@addTagHelper "*, Microsoft.AspNetCore.Mvc.TagHelpers"
@model IEnumerable<ExpenseApp.ViewModels.ExpenseListViewModel>
@{
  Layout = "_Layout";
}

@section Title { @ViewBag.FirstName'@(!ViewBag.FirstName.EndsWith('s') ? "s" : "") Expenses }

@section Header {
  <h1>@ViewBag.FirstName'@(!ViewBag.FirstName.EndsWith('s') ? "s" : "")  Expenses</h1>
}

@section Scripts {
  <script src="~/scripts/ui.js"
          type="text/javascript"
          defer></script>
}

  <main>
    <p>
      <a class="button-primary"
         asp-action="Create">Create New</a>
    </p>

    <div>
      <label>Search:</label>
      <input id="search-input"
             type="search"
             placeholder="Search...">

      <div id="expense-search-type"
           class="radio-container">
        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="search-type"
                 value="statementNumber"
                 onchange="search()"
                 checked>
          <span class="radio-label">Statement Number</span>
        </div>

        <div class="radio-group">
          <input id="title-radio-button"
                 class="radio-button"
                 type="radio"
                 name="search-type"
                 value="title"
                 onchange="search()">
          <span class="radio-label">Title</span>
        </div>
      </div>
    </div>

    <div class="filter">
      <h2>Filter</h2>
      <h3>Status</h3>

      <div class="radio-container">
        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="sort-type"
                 value="none"
                 onchange="search()"
                 checked />
          <label class="radio-label">None</label>
        </div>

        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="sort-type"
                 value="saved"
                 onchange="search()" />
          <label class="radio-label">Saved</label>
        </div>

        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="sort-type"
                 value="submitted"
                 onchange="search()" />
          <label class="radio-label">Submitted</label>
        </div>

        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="sort-type"
                 value="approved"
                 onchange="search()" />
          <label class="radio-label">Approved</label>
        </div>

        <div class="radio-group">
          <input class="radio-button"
                 type="radio"
                 name="sort-type"
                 value="rejected"
                 onchange="search()" />
          <label class="radio-label">Rejected</label>
        </div>
      </div>
    </div>

    <table id="expense-table">
      <thead>
        <tr>
          <th>Statement Number</th>
          <th>Title</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @foreach (var listing in Model)
        {
          <tr id="@listing.StatementNumber">
            <td>@listing.StatementNumber</td>
            <td>@listing.Title</td>
            <td>@listing.Status</td>
            <td>
              @if (listing.Status == ExpenseApp.Models.DB.Status.Saved ||
                listing.Status == ExpenseApp.Models.DB.Status.Rejected)
              {
                @Html.ActionLink("Edit", "Edit", "Form", new
                {
                  statementNumber = listing.StatementNumber
                })<span> | </span>
              }
              @Html.ActionLink("Details", "Details", "Form", new
              {
                statementNumber = listing.StatementNumber
              })
            </td>
          </tr>
        }
        @if (Model.Count() == 0)
        {
          <tr>
            <td colspan="4">
              <div class="empty-list-label">There are no Expense Reports.</div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </main>